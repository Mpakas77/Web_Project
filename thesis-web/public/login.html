<!doctype html><html lang="el"><meta charset="utf-8">
<title>Σύνδεση</title>
<link rel="stylesheet" href="css/styles.css">
<body>
<main class="center card">
<h2>Σύνδεση</h2>
<form id="f">
<input name="email" type="email" placeholder="email" required>
<input name="password" type="password" placeholder="password" required>
<button class="btn" type="submit">Login</button>
</form>
<p id="err" class="error"></p>
</main>
<script type="module">
import { apiPost, setAuth, me } from './js/auth.js';
if (await me()) location.replace('app.html');
document.getElementById('f').addEventListener('submit', async (e)=>{
e.preventDefault();
const data = Object.fromEntries(new FormData(e.target).entries());
const res = await apiPost('../api/auth/login.php', data);

if (!res.ok) return document.getElementById('err').textContent = res.error || 'Σφάλμα';
setAuth(true);
const u = await me();
const m = { teacher:'teacher.html', student:'student.html', secretariat:'secretariat.html' };
location.replace(m[u.role] || 'app.html');
});
</script>
</body></html>